(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{141:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=i.a.createContext({}),p=function(e){var t=i.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},d=function(e){var t=p(e.components);return i.a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},b=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),d=p(n),b=a,m=d["".concat(o,".").concat(b)]||d[b]||u[b]||r;return n?i.a.createElement(m,s(s({ref:t},l),{},{components:n})):i.a.createElement(m,s({ref:t},l))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=b;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var l=2;l<r;l++)o[l]=n[l];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},188:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/ci2-8aaa6fd15202dafe08211b5f69cb76b0.jpg"},73:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return p}));var a=n(3),i=n(7),r=(n(0),n(141)),o={id:"create",title:"Create a Gradle Java Project"},s={unversionedId:"rd/ci/create",id:"rd/ci/create",isDocsHomePage:!1,title:"Create a Gradle Java Project",description:"We will set up a CI/CD pipeline for a Java Gradle project. The project resides and is maintained in a Github repository. Anytime a new push or a pull request is made on the repo, the latest version of the project's code is compiled and built, tested againsted all the existing (unit) tests, and published as a docker image into Docker Hub. Along the way, we explore some exciting topics such as the use of secrets in GitHub Actions, running tests against the project's code and reporting code coverages, and conditional publishing to Docker Hub only if a certain coverage treshold is met. By the end of this tutorial you should have a fully automated GitHub Action pipleline that publishes your tested Java application as a container image to Docker Hub.",source:"@site/docs\\rd\\ci\\create.md",slug:"/rd/ci/create",permalink:"/cs422_sp24/docs/rd/ci/create",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/rd/ci/create.md",version:"current"},c=[{value:"Create a Java Gradle Project",id:"create-a-java-gradle-project",children:[]}],l={toc:c};function p(e){var t=e.components,o=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},l,o,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"We will set up a CI/CD pipeline for a Java Gradle project. The project resides and is maintained in a Github repository. Anytime a new ",Object(r.b)("em",{parentName:"p"},"push")," or a ",Object(r.b)("em",{parentName:"p"},"pull request")," is made on the repo, the latest version of the project's code is compiled and built, tested againsted all the existing (unit) tests, and published as a docker image into ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://hub.docker.com/"}),"Docker Hub"),". Along the way, we explore some exciting topics such as the use of secrets in GitHub Actions, running tests against the project's code and reporting code coverages, and conditional publishing to Docker Hub only if a certain coverage treshold is met. By the end of this tutorial you should have a fully automated GitHub Action pipleline that publishes your tested Java application as a container image to Docker Hub."),Object(r.b)("p",null,"The following picture shows the main steps in the pipleline:"),Object(r.b)("p",null,Object(r.b)("img",{src:n(188).default})),Object(r.b)("p",null,"Anytime a developer pushes code to the repo the latest code is built, before the tests are run against it. Once all tests are exectued (and passed), we publish the latest build of the app (i.e. ",Object(r.b)("inlineCode",{parentName:"p"},"JAR")," file) as a docker image into Docker Hub."),Object(r.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"}),Object(r.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})))),"IDE & Build Tools")),Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"The instructions that follow use Gradle & Intellij, but feel free to use an IDE/tools of your choice!"))),Object(r.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(r.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"ci-helloworld")),Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"The complete code for ",Object(r.b)("inlineCode",{parentName:"p"},"ci-helloworld")," example (that we create step-by-step in the following several sections) can be found at: ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/jhu-st/ci-helloworld/"}),"https://github.com/jhu-st/ci-helloworld/")))),Object(r.b)("h2",{id:"create-a-java-gradle-project"},"Create a Java Gradle Project"),Object(r.b)("p",null,"Create brand new Java Gradle project called ",Object(r.b)("strong",{parentName:"p"},"ci-helloworld"),"."),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Under ",Object(r.b)("inlineCode",{parentName:"li"},"src/main/java")," folder, create a class named ",Object(r.b)("inlineCode",{parentName:"li"},"ArrayUtils.java")," with two methods:")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"public class ArrayUtils {\n\n     /**\n     * Find last index of element\n     *\n     * @param x array to search\n     * @param y value to look for\n     * @return last index of y in x; -1 if absent\n     * @throws NullPointerException if x is null\n     */\n    // test: x = [2, 3, 5]; y = 2; Expected = 0\n    public static int findLast (int[] x, int y) {\n        for (int i=x.length-1; i >= 0; i--) {\n            if (x[i] == y) {\n                return i;\n            }\n        }\n        return -1;\n    }\n\n    /**\n     * Count odd or positive elements\n     *\n     * @param x array to search\n     * @return count of odd/positive values in x\n     * @throws NullPointerException if x is null\n     */\n    // test: x = [-3, -2, 0, 1, 4]; Expected = 3\n    public static int oddOrPos(int[] x) {\n        int count = 0;\n        for (int i = 0; i < x.length; i++) {\n            if (x[i] % 2 != 0 || x[i] > 0) {\n                count++;\n            }\n        }\n        return count;\n    }\n}\n")),Object(r.b)("p",null,"Next, create a second class named ",Object(r.b)("inlineCode",{parentName:"p"},"Main")," which is where the ",Object(r.b)("inlineCode",{parentName:"p"},"main")," function resides:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'public class Main {\n    public static void main(String[] args) {\n        System.out.println("Main Executed!");\n    }\n}\n')),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"main")," function does not do much but we simply include it to have an entry point of execution for the project (if the project is ever executed!); The goal of our project is though to have a set of unit tests (see next step) run against the methods of ",Object(r.b)("inlineCode",{parentName:"p"},"ArrayUtils")," class."),Object(r.b)("ol",{start:2},Object(r.b)("li",{parentName:"ol"},"Under ",Object(r.b)("inlineCode",{parentName:"li"},"test/java")," create a test class named ",Object(r.b)("inlineCode",{parentName:"li"},"ArrayUtilsTest.java")," with the following test methods:")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"import org.junit.jupiter.api.Test;\nimport static org.junit.jupiter.api.Assertions.*;\n\npublic class ArrayUtilsTest {\n\n    @Test\n    public void testFindLastNull() {\n        // Do not execute fault\n        assertThrows(NullPointerException.class, () -> {ArrayUtils.findLast(null, 3);});\n    }\n\n\n    @Test\n    public void testFindLastEmpty() {\n        // For any input where y appears in the second or later position, there is no error. Also,\n        // if x is empty, there is no error.\n        assertEquals(-1, ArrayUtils.findLast(new int[]{}, 3));\n    }\n\n    @Test\n    public void testFindLastNonExistent() {\n        assertEquals(-1, ArrayUtils.findLast(new int[]{1, 2}, 3));\n    }\n\n    @Test\n    public void testFindLastExistsFirstElement() {\n        assertEquals(0, ArrayUtils.findLast(new int[]{2, 3, 5}, 2));\n    }\n\n    @Test\n    public void testOddOrPosNull() {\n        // Do not execute fault\n        assertThrows(NullPointerException.class, () -> {ArrayUtils.oddOrPos(null);});\n    }\n\n\n    @Test\n    public void testOddOrPosAllPositives() {\n        // Any nonempty x with only non-negative elements works, because the first part of the\n        // compound if-test is not necessary unless the value is negative.\n        assertEquals(3, ArrayUtils.oddOrPos(new int[]{1, 2, 3}));\n    }\n\n    @Test\n    public void testOddOrPositiveBothPositivesAndNegatives() {\n        assertEquals(3, ArrayUtils.oddOrPos(new int[]{-3, -2, 0, 1, 4}));\n    }\n}\n")),Object(r.b)("ol",{start:3},Object(r.b)("li",{parentName:"ol"},"Next is ",Object(r.b)("inlineCode",{parentName:"li"},"build.gradle"),":")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-groovy"}),"plugins {\n    id 'java'\n    id 'jacoco'\n}\n\ngroup 'org.example'\nversion '1.0-SNAPSHOT'\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.8.1'\n    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.8.1'\n}\n\ntest {\n    useJUnitPlatform()\n}\n\njar {\n    manifest {\n        attributes 'Main-Class': 'Main'\n    }\n}\n\njacocoTestReport {\n    dependsOn test\n    reports {\n        csv.required = true\n    }\n}\n\ntasks.withType(Test) {\n    testLogging {\n        exceptionFormat \"full\"\n        events \"started\", \"skipped\", \"passed\", \"failed\"\n        showStandardStreams true\n    }\n}\n")),Object(r.b)("p",null,"This makes sure that both ",Object(r.b)("inlineCode",{parentName:"p"},"JUnit")," and ",Object(r.b)("inlineCode",{parentName:"p"},"Jacoco")," are imported into the project. It also has instructions on how to make a ",Object(r.b)("inlineCode",{parentName:"p"},"JAR"),' file by specifying the "main" class of the prject (i.e., the class that contains the ',Object(r.b)("inlineCode",{parentName:"p"},"main")," function). Finally, it has instructions for printing each test case status on the standard output when the tests are executed. "),Object(r.b)("ol",{start:4},Object(r.b)("li",{parentName:"ol"},"Last but not the least, ",Object(r.b)("inlineCode",{parentName:"li"},"add"),", ",Object(r.b)("inlineCode",{parentName:"li"},"commit")," and ",Object(r.b)("inlineCode",{parentName:"li"},"push")," the project to a Github repo named ",Object(r.b)("inlineCode",{parentName:"li"},"ci-helloworld")," on your Github account.")))}p.isMDXComponent=!0}}]);